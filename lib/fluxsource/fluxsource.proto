syntax = "proto2";

import "lib/common.proto";

message HardwareFluxSourceProto {
	optional int32 drive = 1 [default = 0];
	optional double revolutions = 2 [default = 1.2];

	optional bool sync_with_index = 3 [default = false];
	optional IndexMode index_mode = 4 [default = INDEXMODE_DRIVE];
	optional int32 hard_sector_count = 5 [default = 0];
	optional bool high_density = 6
		[default = true, (help) = "set if this is a high density disk"];
}

message TestPatternFluxSourceProto {
	optional double interval_us = 1 [default = 4.0];
	optional double sequence_length_us = 2 [default = 200.0];
}

message EraseFluxSourceProto {}

message KryofluxFluxSourceProto {
	optional string directory = 1 [(help) = "path to Kryoflux stream directory"];
}

message FluxSourceProto {
	oneof source {
		string fluxfile = 1;
		HardwareFluxSourceProto drive = 2;
		TestPatternFluxSourceProto test_pattern = 3;
		EraseFluxSourceProto erase = 4;
		KryofluxFluxSourceProto kryoflux = 5;
	}
}

